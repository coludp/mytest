<?php 

//                            _ooOoo_
//                           o8888888o
//                           88" . "88
//                           (| -_- |)
//                            O\ = /O
//                        ____/`---'\____
//                      .   ' \\| |// `.
//                       / \\||| : |||// \
//                     / _||||| -:- |||||- \
//                       | | \\\ - /// | |
//                     | \_| ''\---/'' | |
//                      \ .-\__ `-` ___/-. /
//                   ___`. .' /--.--\ `. . __
//                ."" '< `.___\_<|>_/___.' >'"".
//               | | : `- \`.;`\ _ /`;.`/ - ` : | |
//                 \ \ `-. \_ __\ /__ _/ .-` / /
//         ======`-.____`-.___\_____/___.-`____.-'======
//                            `=---='
//
//         .............................................
//                  菴帷･夜芙讌ｼ                  BUG霎滓・


$data = "xxxx";
//echo count($data);
if(count($data)==0 || !$data){
	if($data){
		echo 1;
	}else{
		echo 2;
	}
	
}else{
	echo 3;
}
$str_json = '{"auth_key":"CJN0G5258GELY0A54XTSM0TICD57L33P-5DRM1PE6UPC18616G2XY9VRRZV7C1NVHVQZC4OZJ6PIBPGMERIY066XGBPR5Q1WK","uniq_key":"11111120003","bike_info":{"stockbike_id":"","client_id":"0100001","maker_id":"1","syasyu_id":"1010001","syasyu_text":"\u30c8\u30a5\u30c7\u30a4\u30fb\uff26","katashiki_id":"-1","katashiki":"\u4e0d\u660e","haiki_id":"400","haiki":"400","nenshiki_t_no":"2016","nenshiki_t_chk":"AVAIL","ken_year":"2016","ken_month":"6","ken_type":"INSPECTION","soukou":"100021","soukou_chk":"AVAIL","iro_index":"3004","b_iro_n":"\u30d6\u30e9\u30c3\u30af\u2161","b_iro_i_n":"\u9ed2","kakaku":"480000","kakaku_chk":"1","total_price":"495000","frame_no":"0623test-005","photo_cnt":"8","fukabun_n":"EB\u4ed8\u52a0\u6587\u30c6\u30b9\u30c8\uff7c\uff9e\uff7d\uff9e\uff7e\uff9e\uff7f\uff9e\uff80\uff9e\uff81\uff9e\uff82\uff9e\uff83\uff9e\uff84\uff9e\uff8a\uff9e\uff8b\uff9e\uff8c\uff9e\uff8d\uff9e\uff8e\uff9e\uff8a\uff9f\uff8b\uff9f\uff8c\uff9f\uff8d\uff9f","chatch_n":"\u5927\u5224\u30ad\u30e3\u30c3\u30c1\u30c6\u30b9\u30c8","fukabun_n_web":"?_\uff76\uff9e\uff77\uff9e\uff78\uff9e\uff79\uff9e\uff7a\uff9e\uff7b\uff9e\uff7c\uff9e\uff7d\uff9e\uff7e\uff9e\uff7f\uff9e\uff80\uff9e\uff81\uff9e\uff82\uff9e\uff83\uff9e\uff84\uff9e\uff8a\uff9e\uff8b\uff9e\uff8c\uff9e\uff8d\uff9e\uff8e\uff9e\uff8a\uff9f\uff8b\uff9f\uff8c\uff9f\uff8d\uff9f\uff8e\uff9f\uff73\uff9e\uff71\uff72\uff73\uff74\uff75\uff76\uff77\uff78\uff79\uff7a\uff7b\uff7c\uff7d\uff7e\uff7f\uff80\uff81\uff82\uff83\uff84\uff85\uff86\uff87\uff88\uff89\uff8a\uff8b\uff8c\uff8d\uff8e\uff8f\uff90\uff91\uff92\uff93\uff94\uff95\uff96\uff97\uff98\uff99\uff9a\uff9b\uff9c\uff66\uff9d\uff67\uff68\uff69\uff6a\uff6b\uff6f\uff6c\uff6e\uff6d\uff61\uff64\uff65\uff70\u2161\u2162\u2163\u2164\u2165\u2166\u2167\u2168\u2169 \u2170 \u2171 \u2172 \u2173 \u2174 \u2175 \u2176 \u2177 \u2178 \u2179 \u2211 \u22bf \u222e\u2460 \u2461 \u2462 \u2463 \u2464 \u2465 \u2466 \u2467 \u2468 \u2469 \u246a \u246b \u246c \u246d \u246e \u246f \u2470 \u2471 \u2472\u2473\u301d \u301f","salesman_id":"1","youto_flag":"1","seizou_kuni_id":"1","seizou_kuni":"\u65e5\u672c","syuuhuku_flag":"YES","yunyusya_flag":"1","one_owner_flag":"1","normal_flag":"1","guarantee_flag":"1","repair_flag":"1","reimport_flag":"1","tsuuhan_flag":"1","newbike_flag":"1","img_text1":"321","img_text2":"321","img_text3":"321","img_text4":"321","img_text5":"321","img_text6":"321","img_text7":"321","img_text8":"3122","meter_outside_flag":"1","audio_flag":"1","security_flag":"1","cell_add_flag":"1","navi_flag":"1","abs_flag":"1","muffler_outside_flag":"1","fullcustom_flag":"1","remodel_official_flag":"1","maker_official_flag":"1","quality_flag":"1","maker_guarantee_flag":"1","kyabu_fi_flag":"1","suto_flag":"1","hid_flag":"1","etc_flag":"1","boaup_flag":"1","mt_at_flag":"1","er_ducati_tractctrl":"0","er_ducati_meterchg":"0","er_ducati_modelyear":"0","osusume_flag":"1","appraisal_flag":"0"},"supply_info":{"company_id":"153","company_kanji_nm":"\uff22\uff24\uff33","company_kana_nm":"\u30d3\u30fc\u30c7\u30a3\u30fc\u30a8\u30b9","kubun":"1"},"bike_supply_info":{"shiire_year":"2016","shiire_month":"12","shiire_day":"3","shiire_price":"9408","bikou":"1"}}';

$data = json_decode($str_json,true);
$enc=new stdClass;
$enc->from="UTF-8";
$enc->to="SHIFT_JIS";
if(is_array($data)){
array_walk_recursive($data,'bsmapi_convert_enc',$enc);
}
var_dump($data);

function bsmapi_convert_enc(&$value,$key,$enc){
	$value = bsmapi_mdcs_length($value);
    
    $value = mb_convert_encoding($value,$enc->to,$enc->from);
}

function bsmapi_mdcs_length($str){
    if( ! isset( $str ) || $str == FALSE || $str == "" ){
        return( $str );
    }
    $pattern=array(  // 縺薙・驟榊・縺ｯUTF-8縺ｧ縺吶・
        "\xe3\x8e\x9c",   // mm
        "\xe3\x8e\x9d",   // cm
        "\xe3\x8e\x9e",   // km
        "\xe3\x8e\x8e",   // mg
        "\xe3\x8e\x8f",   // kg
        "\xe3\x8f\x84",   // cc
        "\xe3\x8e\xa1",   // m^2
        "\xe2\x84\x96",   // No.
        "\xe3\x8f\x8d",   // K.K.
        "\xe2\x84\xa1",   // TEL
        "\xe3\x8d\x89",   // 繝溘Μ
        "\xe3\x8c\x94",   // 繧ｭ繝ｭ
        "\xe3\x8c\xa2",   // 繧ｻ繝ｳ繝・
        "\xe3\x8d\x8d",   // 繝｡繝ｼ繝医Ν
        "\xe3\x8c\x98",   // 繧ｰ繝ｩ繝
        "\xe3\x8c\xa7",   // 繝医Φ
        "\xe3\x8c\x83",   // 繧｢繝ｼ繝ｫ
        "\xe3\x8c\xb6",   // 繝倥け繧ｿ繝ｼ繝ｫ
        "\xe3\x8d\x91",   // ・ｬ
        "\xe3\x8d\x97",   // 繝ｯ繝・ヨ
        "\xe3\x8c\x8d",   // 繧ｫ繝ｭ繝ｪ繝ｼ
        "\xe3\x8c\xa6",   // 繝峨Ν
        "\xe3\x8c\xa3",   // 繧ｻ繝ｳ繝・
        "\xe3\x8c\xab",   // 繝代・繧ｻ繝ｳ繝・
        "\xe3\x8d\x8a",   // 繝溘Μ繝舌・繝ｫ
        "\xe3\x8c\xbb",   // 繝壹・繧ｸ
        "\xe3\x8a\xa4",   // 荳・
        "\xe3\x8a\xa5",   // 荳ｭ
        "\xe3\x8a\xa6",   // 荳・
		"\xe3\x8a\xa7",   // 蟾ｦ
        "\xe3\x8a\xa8",   // 蜿ｳ
        "\xe3\x88\xb1",   // (譬ｪ)
        "\xe3\x88\xb2",   // (譛・
        "\xe3\x88\xb9",   // (莉｣)
        "\xe3\x8d\xbe",   // 譏取ｲｻ
        "\xe3\x8d\xbd",   // 螟ｧ豁｣
        "\xe3\x8d\xbc",   // 譏ｭ蜥・
        "\xe3\x8d\xbb",   // 蟷ｳ謌・
        "\xe2\x85\xa0",   // I
        "\xe2\x85\xa1",   // II
        "\xe2\x85\xa2",   // III
        "\xe2\x85\xa3",   // IV
        "\xe2\x85\xa4",   // V
        "\xe2\x85\xa5",   // VI
        "\xe2\x85\xa6",   // VII
        "\xe2\x85\xa7",   // VIII
        "\xe2\x85\xa8",   // IX
        "\xe2\x85\xa9",   // X
        "\xe2\x85\xb0",  //i
        "\xe2\x85\xb1",  //ii
        "\xe2\x85\xb2",  //iii
        "\xe2\x85\xb3",  //iv
        "\xe2\x85\xb4",  //v
        "\xe2\x85\xb5",  //vi
        "\xe2\x85\xb6",  //vii
        "\xe2\x85\xb7",  //viii
        "\xe2\x85\xb8",  //ix
        "\xe2\x85\xb9",  //x
        "\xe2\x88\x91",   // ﾎ｣
        "\xe2\x8a\xbf",   // ﾎ・
        "\xe2\x88\xae",   // 竏ｫ
        "\xe2\x91\xa0",   // 1
        "\xe2\x91\xa1",   // 2
		"\xe2\x91\xa2",   // 3
        "\xe2\x91\xa3",   // 4
        "\xe2\x91\xa4",   // 5
        "\xe2\x91\xa5",   // 6
        "\xe2\x91\xa6",   // 7
        "\xe2\x91\xa7",   // 8
        "\xe2\x91\xa8",   // 9
        "\xe2\x91\xa9",   // 10
        "\xe2\x91\xaa",   // 11
        "\xe2\x91\xab",   // 12
        "\xe2\x91\xac",   // 13
        "\xe2\x91\xad",   // 14
        "\xe2\x91\xae",   // 15
        "\xe2\x91\xaf",   // 16
        "\xe2\x91\xb0",   // 17
        "\xe2\x91\xb1",   // 18
        "\xe2\x91\xb2",   // 19
        "\xe2\x91\xb3",   // 20
        "\xe3\x80\x9d",   //"
        "\xe3\x80\x9f"    //,,
    );
	  $replacement = array( 'mm', 'cm', 'km', 'mg', 'kg', 'cc', 'm^2', 'No.',
        'K.K.', 'TEL',
        'ミリ', 'キロ', 'センチ', 'メートル', 'グラム', 'トン', 'アール', 'ヘクタール',
        'Ｌ', 'ワット', 'カロリー', 'ドル', 'セント', 'パーセント', 'ミリバール', 'ページ',
        '上', '中', '下', '左', '右', '(株)', '(有)', '(代)',
        '明治', '大正', '昭和', '平成',
        'I' , 'II', 'III', 'IV', 'V' , 'VI', 'VII', 'VIII', 'IX', 'X',
        'i','ii','iii','iv','v','vi','vii','viii','ix','x',
        'Σ', 'Δ', '∫',
        '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13',
        '14', '15', '16', '17', '18', '19', '20','"',',,'
    );
	//var_dump($pattern);exit;
    $counts = count( $pattern );
    for( $i = 0; $i < $counts; ++$i ){
        $str = str_replace( $pattern[ $i ], $replacement[ $i ], $str );
    }
    $code = mb_detect_encoding($str, array("ASCII","UTF-8","EUC-JP","SHIFT_JIS","SJIS"));
    $str = mb_convert_encoding($str, "UTF-8", $code);
    return( $str );
}
echo "'Σ', 'Δ', '∫',";
?>


